(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))y(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&y(d)}).observe(document,{childList:!0,subtree:!0});function a(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function y(t){if(t.ep)return;t.ep=!0;const o=a(t);fetch(t.href,o)}})();const s=document.getElementById("start-game"),i=document.getElementById("game-result"),r=document.getElementById("game-canvas"),n=r==null?void 0:r.getContext("2d"),c=800,w=450,h=10,I=80,v=6,f=document.getElementById("login-google");f==null||f.addEventListener("click",()=>{window.open("http://localhost:3000/api/auth/login/google","_blank")});let u,m,g;s==null||s.addEventListener("click",()=>{fetch("http://localhost:3001/api/game",{method:"POST"}).then(e=>e.json()).then(e=>{u=e.gameId,m=e.playerId,document.querySelector("table").style.display="none",s.style.display="none",i.style.display="none",r&&(r.style.display="block",r.focus()),g=window.setInterval(E,1e3/60),b()}).catch(e=>{i&&(i.innerHTML=`<div class="alert alert-danger">Error: ${e}</div>`)})});function E(){fetch(`http://localhost:3001/api/game/${u}/state`).then(e=>e.json()).then(e=>{L(e),e.isGameOver&&(clearInterval(g),i&&(i.style.display="block",i.innerHTML=`<h3>Game Over: ${e.winner} wins!</h3>`))})}function L(e){!n||!r||(n.clearRect(0,0,c,w),n.fillStyle="white",n.beginPath(),n.arc(e.ball.x,e.ball.y,v,0,Math.PI*2),n.fill(),n.fillStyle="white",e.players.forEach(l=>{const a=l.side==="left"?0:c-h;n.fillRect(a,l.paddle.y,h,I)}),n.fillStyle="white",n.font="20px sans-serif",n.fillText(`${e.players[0].score}`,c/4,20),n.fillText(`${e.players[1].score}`,c*3/4,20))}function b(){window.addEventListener("keydown",e=>{e.key==="ArrowUp"&&p("move_up"),e.key==="ArrowDown"&&p("move_down")}),window.addEventListener("keyup",e=>{(e.key==="ArrowUp"||e.key==="ArrowDown")&&p("stop")})}function p(e){fetch(`http://localhost:3001/api/game/${u}/input`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playerId:m,type:e,ts:Date.now()})})}
