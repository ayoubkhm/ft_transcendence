(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const f of o.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function l(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(t){if(t.ep)return;t.ep=!0;const o=l(t);fetch(t.href,o)}})();const d=document.getElementById("start-game"),c=document.getElementById("game-result"),s=document.getElementById("game-canvas"),n=s==null?void 0:s.getContext("2d"),a=800,w=450,m=10,I=80,v=6,u=document.getElementById("login-google");u==null||u.addEventListener("click",()=>{window.open("/api/auth/login/google","_blank")});let p,g,h;d==null||d.addEventListener("click",()=>{const e=document.getElementById("difficulty"),r=e==null?void 0:e.value,l={method:"POST"};r&&(l.headers={"Content-Type":"application/json"},l.body=JSON.stringify({difficulty:r})),fetch("/api/game",l).then(i=>i.json()).then(i=>{p=i.gameId,g=i.playerId,document.querySelector("table").style.display="none",d.style.display="none",c.style.display="none",s&&(s.style.display="block",s.focus()),h=window.setInterval(E,1e3/60),b()}).catch(i=>{c&&(c.innerHTML=`<div class="alert alert-danger">Error: ${i}</div>`)})});function E(){fetch(`/api/game/${p}/state`).then(e=>e.json()).then(e=>{L(e),e.isGameOver&&(clearInterval(h),c&&(c.style.display="block",c.innerHTML=`<h3>Game Over: ${e.winner} wins!</h3>`))})}function L(e){!n||!s||(n.clearRect(0,0,a,w),n.fillStyle="white",n.beginPath(),n.arc(e.ball.x,e.ball.y,v,0,Math.PI*2),n.fill(),n.fillStyle="white",e.players.forEach(r=>{const l=r.side==="left"?0:a-m;n.fillRect(l,r.paddle.y,m,I)}),n.fillStyle="white",n.font="20px sans-serif",n.fillText(`${e.players[0].score}`,a/4,20),n.fillText(`${e.players[1].score}`,a*3/4,20))}function b(){window.addEventListener("keydown",e=>{e.key==="ArrowUp"&&y("move_up"),e.key==="ArrowDown"&&y("move_down")}),window.addEventListener("keyup",e=>{(e.key==="ArrowUp"||e.key==="ArrowDown")&&y("stop")})}function y(e){fetch(`/api/game/${p}/input`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({playerId:g,type:e,ts:Date.now()})})}
